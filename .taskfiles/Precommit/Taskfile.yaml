# yaml-language-server: $schema=https://taskfile.dev/schema.json
version: "3"

includes:
  brew:
    taskfile: ../Brew/Taskfile.yaml
    internal: true

tasks:

  init:
    silent: true
    dir: '{{.USER_WORKING_DIR}}'
    deps:
    - brew:install-pre-commit
    desc: Initialize pre-commit hooks
    cmds:
    - pre-commit install --install-hooks
    - pre-commit install --hook-type commit-msg
    status:
    - grep -q 'File generated by pre-commit' .git/hooks/commit-msg
    - grep -q 'File generated by pre-commit' .git/hooks/pre-commit

  run:
    desc: Run pre-commit
    deps:
    - brew:install-pre-commit
    cmds:
    - pre-commit run

  run-all:
    desc: Run pre-commit
    deps:
    - brew:install-pre-commit
    cmds:
    - pre-commit run --all-files

  update:
    desc: Update pre-commit hooks
    deps:
    - brew:install-pre-commit
    cmds:
    - pre-commit autoupdate
